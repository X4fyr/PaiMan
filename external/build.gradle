import java.nio.file.Files

task compileTornadoFxJar(type: Exec) {
    doFirst {
        if (new File(projectDir.absolutePath + '/tornadofx/target/tornadofx-1.7.4-SNAPSHOT.jar').exists()){
            println("SKIP")
            throw new StopExecutionException()
        }
    }
    workingDir "tornadofx"
    commandLine "/usr/bin/mvn", "clean", "package"
}

task copyTornadoFxJar(type: Copy) {
    from('tornadofx/target') {
        include "*.jar"
    }
    into "libs/"

    dependsOn compileTornadoFxJar
}

task cleanTornadoFx(type: Exec) {
    workingDir "tornadofx"
    commandLine "/usr/bin/mvn", "clean"
}

task cleanLibs() {
    def libs = new File(projectDir.absolutePath + "/libs").listFiles()
    for (file in libs) {
        file.delete()
    }
}

task clean() {
    dependsOn cleanTornadoFx, cleanLibs
}

task tornadoFx() {
    dependsOn compileTornadoFxJar
    dependsOn copyTornadoFxJar
}
